## Быстрый старт

    $ git clone https://github.com/olivo4ka37/RSS_MICROSERVICES
    $ cd rss_server
    $ make modules_up
    $ make up_build

# REST API
Сервис: api-service это сервис из второго задания, через который мы стучимся в news service и получаем rss источники и items (статьи). 

Для запросов этого сервиса нужен Header: X-Auth-ID, кроме запроса на создание нового пользователя.

В самой базе данных при создании записывается один user uuid и один administrator uuid.

`User uuid:` f4c1755f-5991-4750-91ba-a42f93fd1d4c

`Administrator uuid:` 490d5457-17ec-4a36-a412-5208f6630505

А также подписывает первого пользователя на все источники, это удобно для проверки пагинации. А также устанавливает время последнего захода на 1-ое января 23-ого года. За счет этого можно отследить, что не все посты показываются, так как из всех постов которые мы получаем из этих источников 5~ не актуальные и у них published стоит 21-ого и 22-ого года.

Если вкраце, реализованно все, кроме второго задания под звездочкой (про асинхронную работу воркеров).

`Makefile` Написан для os Windows!

# Адреса запросов

| Url                                 | Method | Body                                                                                               | Description                                                                              |
|:------------------------------------|:-------|:---------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------|
| /source                             | `GET`  |                                                                                                    | **Получить** список доступных rss каналов   (Любой uuid)                                 |
| /source                             | `POST` | {"url": "https://dtf.ru/rss"}                                                                      | **Добавить источник** (доступно только с uuid администратора)                            |
| /subscribe                          | `POST` | {"url": "https://dave.cheney.net/category/golang/feed"}                                            | **Подписаться** на канал  (только user uuid)                                             |
| /unsubscribe                        | `POST` | {"url": "https://dave.cheney.net/category/golang/feed"}                                            | **Получить** список статей с каналов на каторые подписан пользователь (только user uuid) |
| /sources/{id}/news?page={}&limit={} | `GET`  | limit = 6 и limit =18 Неплохи для того, чтобы убедиться в работе пагинации. (Всего в бд 24 айтема) | **Список новостей пользователя** (только user uuid)                                      |
| /sign-up                            | `GET`  |                                                                                                    | **Создать нового пользователя**                                                          |


# Тестовое задание RSS parser

Необходимо спроектировать два микросервиса. Один для фоновой синхронизации данных о статьях с помощью **rss** лент. Второй для предоставления **HTTP** сервера с **RESTAPI**.

## Часть 1. Хранение данных и работа с БД.

Поднять **Postgres** в **docker** и описать запросы **DDL** для создания таблиц, где будут храниться списки доступных лент **rss**, статей с них и пользователей нашего "приложения".

Изначально записать в таблицу доступных лент rss около 10-20 ссылок на ленты с которых будем получать информацию о статьях.
К примеру: можно взять dtf (пример: https://dtf.ru/rss/) статьи Retail.ru (https://www.retail.ru/rss/articles/) и другие, их можно найти в интернете.

Далее нужно создать worker, который будет кешировать источники **rss** (ссылки, которые представлены в примерах) к себе в память раз в **N время**.

Также нужно создать worker, который бы брал **M источников RSS** (где M > 1 и <= кол-во источников RSS) и получал от туда данные об items (статьях или новостях) и писал их в БД со статусом не прочитано, если данная статья уже есть в БД и дата публикации у нее больше чем, то что в БД, то статью надо перезаписать.

## Часть 2. Реализация сервера с REST-API

- Написать HTTP сервер который бы имел методы: Добавлять новые rss источники. Доступно только администратору под авторизацией (В роли авторизации будет выступать uuid, который надо отправить в Header X-Auth-ID)

- Получать список доступных rss лент. Доступно пользователям и Администраторам

- Подписываться на существующие rss ленты, которые доступны в сервисе. Доступно пользователям (В роли авторизации будет выступать uuid, который надо отправить в Header X-Auth-ID и сравнить, что такой пользователь с таким паролем-uuid, уже существует)

- Отписываться от rss лент на которые подписан пользователь. В таком случае убирать запись о том, что статьи с подписанной ленты новые для данного пользователя и не показывать новости из таких статей пользователю.

- Получать список статей (новостей) с ссылками на них с подписанных rss лент. При получении новых статей обозначать их прочитанными для пользователя. Можно реализовать с помощью записи последнего времени просмотра новостей пользователем.

## Задачи со звездочкой

1. Создать и описать make файл для запуска сервиса с помощью docker-compose (postgres и сам сервис)

2.  Реализовать worker из первой части так, чтобы сразу два инстанса воркера могли работать параллельно, и не обрабатывали одновременно одни и те же rss ленты

